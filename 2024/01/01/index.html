<!DOCTYPE html>
<html lang="ja">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">

  
  <title>Skew-T LogP plot by MetPy</title>
  
  <link rel="canonical" href="https://takashiunuma.github.io/blog/2024/01/01/">
  
  <meta name="description" content="はじめに 大気の鉛直構造を把握するため、日々、高層気象観測が行われている。これらは観測としてのみならず、数値予報モデルの初期値・解析値としても用いられる重要な観測データである。本稿では、その観測データを地点毎に把握するための Skew-T LogP plot について述べる。ここでは、MetPy で">
  
  
  <meta name="author" content="Takashi Unuma">
  
  
  
  <meta property="og:site_name" content="Takashi Unuma&#39;s Blog" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Skew-T LogP plot by MetPy" />
  
  <meta property="og:description" content="はじめに 大気の鉛直構造を把握するため、日々、高層気象観測が行われている。これらは観測としてのみならず、数値予報モデルの初期値・解析値としても用いられる重要な観測データである。本稿では、その観測データを地点毎に把握するための Skew-T LogP plot について述べる。ここでは、MetPy で">
  
  <meta property="og:url" content="https://takashiunuma.github.io/blog/2024/01/01/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Skew-T LogP plot by MetPy">
  
  <meta name="twitter:description" content="はじめに 大気の鉛直構造を把握するため、日々、高層気象観測が行われている。これらは観測としてのみならず、数値予報モデルの初期値・解析値としても用いられる重要な観測データである。本稿では、その観測データを地点毎に把握するための Skew-T LogP plot について述べる。ここでは、MetPy で">
  
  
  
  
  <meta name="twitter:url" content="https://takashiunuma.github.io/blog/2024/01/01/" />

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  
<link rel="stylesheet" href="/blog/css/normalize.css">

  
<link rel="stylesheet" href="/blog/css/skeleton.css">

  
<link rel="stylesheet" href="/blog/css/custom.css">

  
<link rel="stylesheet" href="/blog/css/prism-dark.css">

  
<link rel="stylesheet" href="/blog/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/blog/css/user.css">

  

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="/images/favicon.ico">

  <!-- Custom Theme Color Style
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/blog/atom.xml" title="Takashi Unuma's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="Takashi Unuma's Blog" type="application/rss+xml">
</head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="ten columns ml-1">
    <h1 class="mt-2">
      Takashi Unuma&#39;s blog.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/blog/">Home</a>
        
          
          <a href="/blog/archives" class="ml">Archive</a>
          
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h1>Skew-T LogP plot by MetPy</h1>

  <h1>はじめに</h1>
<p>大気の鉛直構造を把握するため、日々、高層気象観測が行われている。これらは観測としてのみならず、数値予報モデルの初期値・解析値としても用いられる重要な観測データである。本稿では、その観測データを地点毎に把握するための Skew-T LogP plot について述べる。ここでは、<a target="_blank" rel="noopener" href="https://github.com/Unidata/MetPy">MetPy</a> で提供されているものを利用し、特に理想化した数値実験の初期値に用いる一点鉛直プロファイルの可視化について紹介する。</p>
<h1>データ</h1>
<p>とある時刻・地点のデータを利用する。<br>
1行目は、地上の気圧 (hPa)・温位 (K)・水蒸気混合比 (g/kg)。<br>
2行目以降は、高度 (m)・温位 (K)・水蒸気混合比 (g/kg)・東西風 (m/s)・南北風 (m/s)。<br>
これを、<code>input_sounding</code> という名前で保存。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> 1000.00  298.81   18.08</span><br><span class="line">  277.04  299.83   16.13   -5.29    1.54</span><br><span class="line">  504.73  299.94   16.02   -5.96    1.84</span><br><span class="line">  736.79  300.06   16.00   -6.08    2.16</span><br><span class="line">  973.81  301.25   15.48   -5.57    3.11</span><br><span class="line"> 1465.20  303.95   14.38   -2.57    5.48</span><br><span class="line"> 1982.15  306.88   12.90    1.13    5.17</span><br><span class="line"> 3104.82  312.11    9.51    5.20    4.45</span><br><span class="line"> 4369.76  318.33    6.41    5.66    4.46</span><br><span class="line"> 5823.29  325.50    4.00   11.84   -0.45</span><br><span class="line"> 7542.22  334.36    1.78   15.32    3.46</span><br><span class="line"> 9655.91  343.85    0.65   15.49   -5.92</span><br><span class="line">12000.00  351.53    0.11   15.49   -5.92</span><br><span class="line">21000.00  500.53    0.01   15.49   -5.92</span><br></pre></td></tr></table></figure>
<h1>ソースコード</h1>
<p>上記のデータを、下記で可視化する。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.dates <span class="keyword">as</span> mdates</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> metpy.calc <span class="keyword">as</span> mpcalc</span><br><span class="line"><span class="keyword">from</span> metpy.calc <span class="keyword">import</span> temperature_from_potential_temperature, height_to_pressure_std, dewpoint_from_specific_humidity</span><br><span class="line"><span class="keyword">from</span> metpy.plots <span class="keyword">import</span> SkewT</span><br><span class="line"><span class="keyword">from</span> metpy.units <span class="keyword">import</span> units, pandas_dataframe_to_unit_arrays</span><br><span class="line"><span class="keyword">import</span> pint_xarray</span><br><span class="line"></span><br><span class="line"><span class="comment"># ヘッダーを取り除いた上でカラムを指定、pandas dataframe として格納。</span></span><br><span class="line">df = pd.read_fwf(<span class="string">&#x27;input_sounding&#x27;</span>, header=<span class="number">0</span>, usecols=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], names=[<span class="string">&#x27;height&#x27;</span>, <span class="string">&#x27;theta&#x27;</span>, <span class="string">&#x27;qv&#x27;</span>, <span class="string">&#x27;uwnd&#x27;</span>, <span class="string">&#x27;vwnd&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># pandas dataframe を xarray dataset に変換</span></span><br><span class="line">ds = df.to_xarray()</span><br><span class="line"></span><br><span class="line"><span class="comment"># MetPy.units を用い、単位を指定。</span></span><br><span class="line">ds[<span class="string">&#x27;height&#x27;</span>] = ds[<span class="string">&#x27;height&#x27;</span>] * units.meter</span><br><span class="line">ds[<span class="string">&#x27;theta&#x27;</span>] = ds[<span class="string">&#x27;theta&#x27;</span>] * units.kelvin</span><br><span class="line">ds[<span class="string">&#x27;qv&#x27;</span>] = ds[<span class="string">&#x27;qv&#x27;</span>] * units(<span class="string">&#x27;g/kg&#x27;</span>)</span><br><span class="line">ds[<span class="string">&#x27;uwnd&#x27;</span>] = ds[<span class="string">&#x27;uwnd&#x27;</span>] * units.meter_per_second</span><br><span class="line">ds[<span class="string">&#x27;vwnd&#x27;</span>] = ds[<span class="string">&#x27;vwnd&#x27;</span>] * units.meter_per_second</span><br><span class="line"></span><br><span class="line"><span class="comment"># SkewT logP plot の描画に必要な変数に変換。</span></span><br><span class="line">ds[<span class="string">&#x27;pressure&#x27;</span>] = height_to_pressure_std(ds[<span class="string">&#x27;height&#x27;</span>]).pint.to(<span class="string">&#x27;hPa&#x27;</span>)</span><br><span class="line">ds[<span class="string">&#x27;temperature&#x27;</span>] = temperature_from_potential_temperature(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;theta&#x27;</span>]).pint.to(<span class="string">&#x27;degC&#x27;</span>)</span><br><span class="line">ds[<span class="string">&#x27;dewpoint&#x27;</span>] = dewpoint_from_specific_humidity(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;temperature&#x27;</span>], ds[<span class="string">&#x27;qv&#x27;</span>]).pint.to(<span class="string">&#x27;degC&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ある高度から持ち上げたパーセルの気温・露点温度のプロファイルを計算。</span></span><br><span class="line">parcel_prof = mpcalc.parcel_profile(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;temperature&#x27;</span>][<span class="number">0</span>], ds[<span class="string">&#x27;dewpoint&#x27;</span>][<span class="number">0</span>]).pint.to(<span class="string">&#x27;degC&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 持ち上げ凝結高度の気圧・気温・露点温度を計算。</span></span><br><span class="line">lcl_pressure, lcl_temperature = mpcalc.lcl(ds[<span class="string">&#x27;pressure&#x27;</span>][<span class="number">0</span>], ds[<span class="string">&#x27;temperature&#x27;</span>][<span class="number">0</span>], ds[<span class="string">&#x27;dewpoint&#x27;</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 描画</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">skew = SkewT(fig)</span><br><span class="line">skew.ax.set_ylim(<span class="number">1050</span>,<span class="number">100</span>)</span><br><span class="line">skew.ax.set_xlim(-<span class="number">30</span>,<span class="number">35</span>)</span><br><span class="line">skew.ax.set_title(<span class="string">&quot;A sample sounding&quot;</span>)</span><br><span class="line">skew.plot(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;temperature&#x27;</span>], color=<span class="string">&quot;k&quot;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">skew.plot(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;dewpoint&#x27;</span>], linestyle=<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">skew.shade_cape(ds[<span class="string">&#x27;pressure&#x27;</span>], ds[<span class="string">&#x27;temperature&#x27;</span>], parcel_prof)</span><br><span class="line">skew.plot(ds[<span class="string">&#x27;pressure&#x27;</span>], parcel_prof, linestyle=<span class="string">&#x27;:&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">skew.plot(lcl_pressure, lcl_temperature, <span class="string">&#x27;ko&#x27;</span>, markerfacecolor=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">skew.plot_moist_adiabats(linewidth=<span class="number">0.5</span>)</span><br><span class="line">fig.savefig(<span class="string">&#x27;skewt.png&#x27;</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 各種指数・パラメーターの計算</span></span><br><span class="line">p = ds[<span class="string">&#x27;pressure&#x27;</span>]</span><br><span class="line">T = ds[<span class="string">&#x27;temperature&#x27;</span>]</span><br><span class="line">Td = ds[<span class="string">&#x27;dewpoint&#x27;</span>]</span><br><span class="line">height = ds[<span class="string">&#x27;height&#x27;</span>]</span><br><span class="line">u = ds[<span class="string">&#x27;uwnd&#x27;</span>]</span><br><span class="line">v = ds[<span class="string">&#x27;vwnd&#x27;</span>]</span><br><span class="line"></span><br><span class="line">ctotals = mpcalc.cross_totals(p, T, Td)</span><br><span class="line">kindex = mpcalc.k_index(p, T, Td)</span><br><span class="line">showalter = mpcalc.showalter_index(p, T, Td)</span><br><span class="line">total_totals = mpcalc.total_totals_index(p, T, Td)</span><br><span class="line">vert_totals = mpcalc.vertical_totals(p, T)</span><br><span class="line">lift_index = mpcalc.lifted_index(p, T, parcel_prof)</span><br><span class="line">cape, cin = mpcalc.cape_cin(p, T, Td, parcel_prof)</span><br><span class="line">lclp, lclt = mpcalc.lcl(p[<span class="number">0</span>], T[<span class="number">0</span>], Td[<span class="number">0</span>])</span><br><span class="line">lfcp, _ = mpcalc.lfc(p, T, Td)</span><br><span class="line">el_pressure, _ = mpcalc.el(p, T, Td, parcel_prof)</span><br><span class="line">ml_t, ml_td = mpcalc.mixed_layer(p, T, Td, depth=<span class="number">50</span> * units.hPa)</span><br><span class="line">ml_p, _, _ = mpcalc.mixed_parcel(p, T, Td, depth=<span class="number">50</span> * units.hPa)</span><br><span class="line">mlcape, mlcin = mpcalc.mixed_layer_cape_cin(p, T, parcel_prof, depth=<span class="number">50</span> * units.hPa)</span><br><span class="line">mu_p, mu_t, mu_td, _ = mpcalc.most_unstable_parcel(p, T, Td, depth=<span class="number">50</span> * units.hPa)</span><br><span class="line">mucape, mucin = mpcalc.most_unstable_cape_cin(p, T, Td, depth=<span class="number">50</span> * units.hPa)</span><br><span class="line">(u_storm, v_storm), *_ = mpcalc.bunkers_storm_motion(p, u, v, height)</span><br><span class="line">critical_angle = mpcalc.critical_angle(p, u, v, height, u_storm, v_storm)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 各種指数・パラメーターの値を確認</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;        CAPE: <span class="subst">&#123;cape:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;         CIN: <span class="subst">&#123;cin:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;LCL Pressure: <span class="subst">&#123;lclp:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;LFC Pressure: <span class="subst">&#123;lfcp:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27; EL Pressure: <span class="subst">&#123;el_pressure:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Mixed Layer - Lowest 50-hPa&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     ML Temp: <span class="subst">&#123;ml_t:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     ML Dewp: <span class="subst">&#123;ml_td:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     ML CAPE: <span class="subst">&#123;mlcape:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;      ML CIN: <span class="subst">&#123;mlcin:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Most Unstable - Lowest 50-hPa&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     MU Temp: <span class="subst">&#123;mu_t:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     MU Dewp: <span class="subst">&#123;mu_td:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27; MU Pressure: <span class="subst">&#123;mu_p:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;     MU CAPE: <span class="subst">&#123;mucape:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;      MU CIN: <span class="subst">&#123;mucin:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;   Lifted Index: <span class="subst">&#123;lift_index:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;        K-Index: <span class="subst">&#123;kindex:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Showalter Index: <span class="subst">&#123;showalter:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;   Cross Totals: <span class="subst">&#123;ctotals:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;   Total Totals: <span class="subst">&#123;total_totals:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Vertical Totals: <span class="subst">&#123;vert_totals:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Bunkers Storm Motion Vector&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;  u_storm: <span class="subst">&#123;u_storm:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;  v_storm: <span class="subst">&#123;v_storm:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Critical Angle: <span class="subst">&#123;critical_angle:<span class="number">.2</span>f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1>出力結果</h1>
<p>図が Skew-T logP plot。横軸は気温または露点温度 (degree C)、縦軸は気圧 (hPa)。黒実線で気温、青実線で露点温度、橙点線で持ち上げたパーセルの気温をそれぞれ示す、赤色の陰影で示される面積は、持ち上げたパーセルと周辺大気との気温差、すなわち対流有効位置エネルギー (CAPE) である。黒丸印は持ち上げ凝結高度 (LCL) を示す。<br>
図の左下から右上に向かう灰色の線は等温線を、図の右下から左上に伸びる青色点線は等湿潤断熱線をそれぞれ示す。</p>
<img src="/blog/2024/01/01/skewt.png" class="">
<p>図の 925 hPa から少なくとも 500 hPa までは、気温と露点温度の線が重なっている。これは、ほぼ相対湿度 100% であることを示す。加えて、800 hPa から 600 hPa までの層では、気温減率の傾きが湿潤断熱線の傾きよりも大きくなっており、湿潤絶対不安定 (Moist Absolutely Unstable Layer, Bryan and Fritsch 2000) の可能性がある。</p>
<p>下記は、一点鉛直プロファイルから得られる指数やパラメーターの出力である。一地点の鉛直プロファイルから、これだけ多様な診断パラメーターを算出することが可能となる。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">        CAPE: 729.54 joule / kilogram</span><br><span class="line">         CIN: -3.21 joule / kilogram</span><br><span class="line">LCL Pressure: 926.10 hectopascal</span><br><span class="line">LFC Pressure: 885.54 hectopascal</span><br><span class="line"> EL Pressure: 260.51 hectopascal</span><br><span class="line"></span><br><span class="line">Mixed Layer - Lowest 50-hPa</span><br><span class="line">     ML Temp: 22.89 degree_Celsius</span><br><span class="line">     ML Dewp: 20.64 degree_Celsius</span><br><span class="line">     ML CAPE: 1997.43 joule / kilogram</span><br><span class="line">      ML CIN: -0.15 joule / kilogram</span><br><span class="line"></span><br><span class="line">Most Unstable - Lowest 50-hPa</span><br><span class="line">     MU Temp: 20.55 degree_Celsius</span><br><span class="line">     MU Dewp: 20.17 degree_Celsius</span><br><span class="line"> MU Pressure: 927.77 hectopascal</span><br><span class="line">     MU CAPE: 754.89 joule / kilogram</span><br><span class="line">      MU CIN: -1.08 joule / kilogram</span><br><span class="line"></span><br><span class="line">   Lifted Index: -3.48 delta_degree_Celsius</span><br><span class="line">        K-Index: 41.32 degree_Celsius</span><br><span class="line">Showalter Index: -3.25 delta_degree_Celsius</span><br><span class="line">   Cross Totals: 24.40 delta_degree_Celsius</span><br><span class="line">   Total Totals: 48.64 delta_degree_Celsius</span><br><span class="line">Vertical Totals: 24.24 delta_degree_Celsius</span><br><span class="line"></span><br><span class="line">Bunkers Storm Motion Vector</span><br><span class="line">  u_storm: 0.25 meter_per_second</span><br><span class="line">  v_storm: -4.63 meter_per_second</span><br><span class="line">Critical Angle: 179.85 degree</span><br></pre></td></tr></table></figure>
<p>指数・診断パラメーターは、発案された地域や特性に依存するため、計算結果をそのまま異なる地域に当てはめることは得策ではない。上記で調べたように、可視化することで指数が意図した計算となっているか、愚直に確認することが重要である (時に時間を要するが)。ここでは、計算方法の紹介に留める。</p>
<h1>おわりに</h1>
<p>大気の状態を把握するための基礎的な観測の一つである、高層気象観測データの可視化と関連する指数・パラメータの計算について紹介した。</p>
<h1>参考文献</h1>
<ul>
<li>May, R. M., Goebbert, K. H., Thielen, J. E., Leeman, J. R., Camron, M. D., Bruick, Z., Bruning, E. C., Manser, R. P., Arms, S. C., and Marsh, P. T., 2022: MetPy: A Meteorological Python Library for Data Analysis and Visualization. Bull. Amer. Meteor. Soc., 103, E2273-E2284, doi:10.1175/BAMS-D-21-0125.1.</li>
<li>Bryan, G. H., and J. M. Fritsch, 2000: Moist Absolute Instability: The Sixth Static Stability State. Bull. Amer. Meteor. Soc., 81, 1207–1230, doi:10.1175/1520-0477(2000)081&lt;1287:MAITSS&gt;<a target="_blank" rel="noopener" href="http://2.3.CO">2.3.CO</a>;2.</li>
</ul>
<h1>更新履歴</h1>
<ul>
<li>2024-01-01: 初稿</li>
</ul>

  <p><a class="classtest-link" href="/blog/tags/Miscellaneous/" rel="tag">Miscellaneous</a> — 2024年1月1日</p>
  
  <hr>
<section id="comments" class="mt-2 mb-3">

  <div id="disqus_thread">
    <a href="#" class="button button-primary" onclick="loadDisqus();return false;">View / Make Comments</a>
  </div>

  <script>
    var disqus_config = function() {
      this.page.url = 'https://takashiunuma.github.io/blog/2024/01/01/index.html';
      this.page.identifier = '2024/01/01/index.html';
      this.page.title = 'Skew-T LogP plot by MetPy';
    };

    var is_disqus_loaded = false;

    function loadDisqus() {
      if (!is_disqus_loaded) {
        is_disqus_loaded = true;

        var d = document,
          s = d.createElement('script');
        s.src = 'https://unusblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      }
    }

  </script>
  <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



        </div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with ❤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://scholar.google.co.jp/citations?user=8PamjYsAAAAJ" target="_blank" rel="noreferrer">Japan</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/TakashiUNUMA" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://www.linkedin.com/in/takashiunuma/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="LinkedIn">
        <svg class="linkedin svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://twitter.com/UNUSB" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Twitter">
        <svg class="twitter svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://www.instagram.com/unusb/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Instagram">
        <svg class="instagram svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram</title><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>
      </a>
      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>
