<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>地上観測データの把握 | Takashi Unuma's Blog</title><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"><script src="/blog/js/third-party/jquery.min.js"></script><script src="/blog/js/third-party/velocity.min.js"></script><script src="/blog/js/third-party/velocity.ui.min.js"></script><link rel="icon" href="/blog/img/favicon.ico"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/blog/atom.xml" title="Takashi Unuma's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="Takashi Unuma's Blog" type="application/rss+xml">
</head><body><nav id="nav-bar"><nav class="clear-fix" id="nav-container"><div class="pull-left" id="page-home"><a href="/blog/">Takashi Unuma's Blog</a></div><i class="fa fa-bars pull-right" id="toggle-nav" aria-hidden="true"></i><ul class="pull-right" id="navs"><li><a class="nav" href="/blog/">Home</a></li><li><a class="nav" href="/blog/about">About</a></li><li><a class="nav" href="/blog/tags">Tags</a></li></ul></nav></nav><header id="header-info"><div id="header-container"><div id="site-info"><div id="terminal-pl"><div id="top-bar"><ul id="control"><li class="btn"></li><li class="btn"></li><li class="btn"></li></ul><div id="file-path"><i class="fa fa-folder folder-ic" aria-hidden="true"></i> @GitHub</div></div><div id="code-pl">@github:~/blog$
<span class="code-pl-input">source &quot;地上観測データの把握.sh&quot;</span><br><br>@github:~/blog$
<span class="code-pl-input">printenv</span><br><span class="code-pl-output">CREATED_DATE = 2021-08-16</span><br><span class="code-pl-output">UPDATED_DATE = 2021-08-22</span><br><span class="code-pl-output">TAGS =</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/tags/#Miscellaneous"><span class="code-pl-output">Miscellaneous</span></a><span class="code-pl-output"> </span><span class="code-pl-output"></span><br><br>@github:~/blog$
<span class="code-pl-input">grep -lr $TAGS post</span><br><span class="code-pl-output">2021-03-23</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/23/" target="_blank"><span class="code-pl-output">Dew Point Temperature</span></a><br><span class="code-pl-output">2021-08-19</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/19/" target="_blank"><span class="code-pl-output">KDP推定アルゴリズムの比較</span></a><br><span class="code-pl-output">2021-03-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/21/" target="_blank"><span class="code-pl-output">SONDE monitor</span></a><br><span class="code-pl-output">2021-09-04</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/04/" target="_blank"><span class="code-pl-output">Self-consistency Principle</span></a><br><span class="code-pl-output">2021-03-22</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/22/" target="_blank"><span class="code-pl-output">Signal Processing Methods</span></a><br><span class="code-pl-output">2021-03-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/20/" target="_blank"><span class="code-pl-output">The first page of my blog</span></a><br><span class="code-pl-output">2021-09-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/20/" target="_blank"><span class="code-pl-output">二重偏波レーダーとメソ対流系</span></a><br><span class="code-pl-output">2021-04-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/04/28/" target="_blank"><span class="code-pl-output">二重偏波要素の特徴</span></a><br><span class="code-pl-output">2022-01-26</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2022/01/26/" target="_blank"><span class="code-pl-output">反射強度・反射因子差のバイアス補正</span></a><br><span class="code-pl-output">2021-08-16</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/16/" target="_blank"><span class="code-pl-output">地上観測データの把握</span></a><br><span class="code-pl-output">2021-10-01</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/10/01/" target="_blank"><span class="code-pl-output">粒径分布とレーダー変数</span></a><br><span class="code-pl-output">2021-08-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/28/" target="_blank"><span class="code-pl-output">二重偏波レーダー変数の算出とその補正</span></a><br><span class="code-pl-output">2021-07-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/07/28/" target="_blank"><span class="code-pl-output">降水強度のKDP推定アルゴリズムについて</span></a><br><!--if page.next| > .prev
br
a(href=url_for(page.next.path))
  span.answer= page.next.title
br
br--><!--if page.prev| > .next
br
a(href=url_for(page.prev.path))
  span.answer= page.prev.title--></div></div></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><a class="article-title">地上観測データの把握</a><time class="article-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-16</time><h1 id="はじめに"><a class="markdownIt-Anchor" href="#はじめに"></a> はじめに</h1>
<p>地上気象観測は、気象観測の中でも歴史が長く、古くから世界各地で実施されている。昔訊いた話では、<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/SYNOP">SYNOP</a> と呼ばれる形式により電文が <a target="_blank" rel="noopener" href="https://public.wmo.int/en/programmes/global-telecommunication-system">GTS</a> に手打ちで送信されるなどしていたそうだ。最近では自動化が進み、電文が管轄する気象官署等で集約された上で自動で一定時刻に流通するようだ (例: <a target="_blank" rel="noopener" href="https://www.jma.go.jp/jma/kishou/know/chijyou/surf.html">地上気象観測</a>; <a target="_blank" rel="noopener" href="https://www.jma.go.jp/jma/kishou/know/amedas/kaisetsu.html">AMeDAS</a>)。地上観測では、ある地点の時系列データが得られる。<br />
　データの形式については、複数地点を集約した離散的なデータとなるためひと工夫必要となる。気象レーダー・ライダーの観測値や数値予報モデルなどは格子点データなので <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/GRIB">GRIB</a> 形式で格納される場合が多い。一方、地上観測データの場合は離散的な地点データとなるため、主に格子点データを扱う GRIB 形式ではデータを格納しづらくなる。このような非格子点形式のデータを表現するために <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/BUFR">BUFR</a> 形式が採用されている。気象庁では、地上観測データ (気象庁内外含む) は本庁で集約・品質管理され、<a target="_blank" rel="noopener" href="https://www.data.jma.go.jp/gmd/risk/obsdl/index.php">気象庁HP</a>や<a target="_blank" rel="noopener" href="http://www.jmbsc.or.jp/jp/online/file/f-online33100.html">気象業務支援センター</a>で公開される。気象庁HPでは csv フォーマットで任意の日時・要素のデータが取得可能になっており、とても便利になった。こちらについては特に言及しない。他方、気象業務支援センターで公開されているデータは、前述の BUFR 形式であり実際に扱ってみるとなかなか苦労した。本稿は BUFR 形式データをデコードし、そのデータを用いて地理空間分布を描くところまでの備忘録である。</p>
<h1 id="データの入手"><a class="markdownIt-Anchor" href="#データの入手"></a> データの入手</h1>
<p>気象業務支援センターでは、<a target="_blank" rel="noopener" href="http://www.jmbsc.or.jp/jp/online/c-onlineGsample.html">実際に配信されたデータによるサンプル提供</a>のページでサンプルデータが公開されている。この中から<a target="_blank" rel="noopener" href="http://www.jmbsc-west.jp/jp/online/online-sample/OBS/OBS_AMDSxx_Rjp_Nx.zip">地域気象観測報</a>を選びダウンロードする。圧縮ファイルを展開すると2020年02月13日 15:10 UTC ～ 2020年02月14日 15:00 UTC のデータが入っている。この中から、下記のデータを例にデコードしてみる。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OBS_AMDSxx_Rjp_Nx&#x2F;AMDS&#x2F;Z__C_RJTD_20200214000000_OBS_AMDS_Rjp_N2_bufr4.bin</span><br></pre></td></tr></table></figure>
<h1 id="フォーマット読解"><a class="markdownIt-Anchor" href="#フォーマット読解"></a> フォーマット読解</h1>
<p>気象業務支援センターから得たサンプルデータは、BUFR version 4 形式となっている。<a target="_blank" rel="noopener" href="http://www.jmbsc.or.jp/jp/online/file/f-online33100.html">気象業務支援センターのページ</a>に配信資料に関する技術資料 (気象編) 第273号という資料があり、<a target="_blank" rel="noopener" href="https://www.data.jma.go.jp/suishin/jyouhou/pdf/273.pdf">これ</a>を参照しながらデコードする。もっと詳しい資料として、<a target="_blank" rel="noopener" href="https://www.jma.go.jp/jma/kishou/books/tsuhoshiki/tsuhoshiki.html">国際気象通報式・別冊</a>というものがあり、これも読解に役立つ。</p>
<h2 id="プログラム"><a class="markdownIt-Anchor" href="#プログラム"></a> プログラム</h2>
<p>BUFR データのデコードは幾つかのやり方があるようだ。	<a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/ECC">ecCodes</a>、<a target="_blank" rel="noopener" href="https://github.com/NOAA-EMC/NCEPLIBS-bufr">NCEPLIBS-bufr</a>、<a target="_blank" rel="noopener" href="https://launchpad.net/libecbufr">LibECBUFR</a>、<a target="_blank" rel="noopener" href="https://github.com/etoyoda/bufrconv">bufrconv</a>、<a target="_blank" rel="noopener" href="https://pybufrkit.readthedocs.io/en/latest/">PyBufrKit</a>等が見つかった。今回は C 言語で扱いたかったので LibECBUFR にお世話になった。LibECBUFR のコンパイル・インストールについては<a target="_blank" rel="noopener" href="https://gitlab.com/unujma/unuwiki/-/wikis/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88#libecbufr">こちら</a>を、下記で利用するサンプルプログラム等は<a target="_blank" rel="noopener" href="https://gitlab.com/unujma/unuwiki/-/snippets/2163731">こちら</a>をそれぞれ参照されたし。</p>
<h2 id="方針"><a class="markdownIt-Anchor" href="#方針"></a> 方針</h2>
<p>LibECBUFR のインストールが出来ていることを前提に話を進める。LibECBUFR は、Table ファイルを参照しながらデコードするようなプログラム構成になっている。気象庁が配信する BUFR 報は、独自 Table でデータが格納されているため LibECBUFR のデフォルトのままではデコード出来ない。そこで、前述の配信資料に関する技術資料を見ながら Table に要素を追記し、その Table ファイルを読ませてデコードするという流れとなる。LibECBUFR には <code>bufr_decoder</code> というユーティリティプログラムが同梱されているので、これを使いながら修正箇所を特定しつつデコードしてみる。</p>
<h2 id="デコード"><a class="markdownIt-Anchor" href="#デコード"></a> デコード</h2>
<p>LibECBUFR に Table ファイルが同梱されているので、まずはこれを使ってみる。Table は、<code>table_b_bufr</code> と <code>table_d_bufr</code> の 2 種類。環境変数 <code>BUFR_TABLES</code> で Table ファイルの場所を指定する。データは先程のサンプルデータを引数で下記のように与えてみる。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUFR_TABLES=./Tables ./bufr_decoder -inbufr Z__C_RJTD_20200214000000_OBS_AMDS_Rjp_N2_bufr4.bin -debug</span><br></pre></td></tr></table></figure>
<p>すると、下記のような標準出力とファイル (<code>DEBUG.decoder</code>) が吐き出される。</p>
<p>標準出力</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">### BUFR Edition              : 4</span><br><span class="line">###          length           : 167201</span><br><span class="line">###   Section 0</span><br><span class="line">###      length               : 8</span><br><span class="line">###   Section 1</span><br><span class="line">###      length               : 22</span><br><span class="line">###      BUFR master table    : 0</span><br><span class="line">###      originating center   : 34</span><br><span class="line">###      sub center           : 0</span><br><span class="line">###      update sequence number : 0</span><br><span class="line">###      Data category        : 0</span><br><span class="line">###      International sub category  : 255</span><br><span class="line">###      Local sub category   : 255</span><br><span class="line">###      master table version : 13</span><br><span class="line">###      local table version  : 1</span><br><span class="line">###      Year                 : 2020</span><br><span class="line">###      Month                : 2</span><br><span class="line">###      Day                  : 14</span><br><span class="line">###      Hour                 : 0</span><br><span class="line">###      Min                  : 0</span><br><span class="line">###      Sec                  : 0</span><br><span class="line">###      octet 8              : 0</span><br><span class="line">###         optional section  : No</span><br><span class="line">###   Section 2</span><br><span class="line">###      length               : 0</span><br><span class="line">###   Section 3</span><br><span class="line">###      length               : 207</span><br><span class="line">###      datasubsets          : 1298</span><br><span class="line">###      octet 7              : 128</span><br><span class="line">###         compression       : No</span><br><span class="line">###         observed data</span><br><span class="line">###   Section 4</span><br><span class="line">###      length               : 166960</span><br><span class="line">###   Section 5</span><br><span class="line">###      length               : 4</span><br><span class="line">###</span><br><span class="line">Error: can&#39;t decode messages</span><br></pre></td></tr></table></figure>
<p><code>DEBUG.decoder</code> (長いので要所のみ)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">### Converting BUFR Message into Dataset</span><br><span class="line">Warning: master Table B version: 35 differs from message&#39;s: 13</span><br><span class="line">Warning: Unknown BUFR descriptor: 25219</span><br><span class="line">Warning: 25219 is a local descriptor</span><br><span class="line">Error: unknown descriptor 25219</span><br></pre></td></tr></table></figure>
<p>どうやら、Table ファイルに未定義の descriptor があるようだ。そこで、<code>DEBUG.decoder</code> でエラーになっている番号とフォーマットの番号とを比較しながら <code>table_b_bufr</code> に追記する。集約演算子がある場合は、<code>table_d_bufr</code> にも追記が必要となる (今回は必要なかった)。最終的にファイルが読めるようになった Table は<a target="_blank" rel="noopener" href="https://gitlab.com/unujma/unuwiki/-/snippets/2163731/raw/main/table_b_bufr">ここ</a>から取得出来る。</p>
<p>修正した Table ファイルを読み込ませると、下記のように出力される (一部のみ)。</p>
<p>コマンド</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUFR_TABLES=./Tables ./bufr_decoder -inbufr Z__C_RJTD_20200214000000_OBS_AMDS_Rjp_N2_bufr4.bin</span><br></pre></td></tr></table></figure>
<p>標準出力</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">### BUFR Edition              : 4</span><br><span class="line">###          length           : 167201</span><br><span class="line">###   Section 0</span><br><span class="line">###      length               : 8</span><br><span class="line">###   Section 1</span><br><span class="line">###      length               : 22</span><br><span class="line">###      BUFR master table    : 0</span><br><span class="line">###      originating center   : 34</span><br><span class="line">###      sub center           : 0</span><br><span class="line">###      update sequence number : 0</span><br><span class="line">###      Data category        : 0</span><br><span class="line">###      International sub category  : 255</span><br><span class="line">###      Local sub category   : 255</span><br><span class="line">###      master table version : 13</span><br><span class="line">###      local table version  : 1</span><br><span class="line">###      Year                 : 2020</span><br><span class="line">###      Month                : 2</span><br><span class="line">###      Day                  : 14</span><br><span class="line">###      Hour                 : 0</span><br><span class="line">###      Min                  : 0</span><br><span class="line">###      Sec                  : 0</span><br><span class="line">###      octet 8              : 0</span><br><span class="line">###         optional section  : No</span><br><span class="line">###   Section 2</span><br><span class="line">###      length               : 0</span><br><span class="line">###   Section 3</span><br><span class="line">###      length               : 207</span><br><span class="line">###      datasubsets          : 1298</span><br><span class="line">###      octet 7              : 128</span><br><span class="line">###         compression       : No</span><br><span class="line">###         observed data</span><br><span class="line">###   Section 4</span><br><span class="line">###      length               : 166960</span><br><span class="line">###   Section 5</span><br><span class="line">###      length               : 4</span><br><span class="line">###</span><br><span class="line">## Subset 1 : 132 descriptors</span><br><span class="line">  001202                INSTUTUTION NUMBER                                               CODE TABLE              1 </span><br><span class="line">  001200                PREFECTURE DISPLAY NUMBER                                        NUMERIC                 11 </span><br><span class="line">  001201                POINT DISPLAY NUMBER                                             NUMERIC                 1 </span><br><span class="line">  002001                TYPE OF STATION                                                  CODE TABLE              0 </span><br><span class="line"># 301011          </span><br><span class="line">  004001                YEAR                                                             YEAR                    2020 </span><br><span class="line">  004002                MONTH                                                            MONTH                   2 </span><br><span class="line">  004003                DAY                                                              DAY                     14 </span><br><span class="line"># 301012          </span><br><span class="line">  004004                HOUR                                                             HOUR                    0 </span><br><span class="line">  004005                MINUTE                                                           MINUTES                 0 </span><br><span class="line"># 301021          </span><br><span class="line">  005001                LATITUDE(HIGH ACCURACY)                                          DEGREE                  45.52111</span><br><span class="line">  006001                LONGITUDE (HIGH ACCURACY)                                        DEGREE                  141.93611</span><br><span class="line">  007030                HEIGHT OF STATION GROUND ABV MSL                                 M                       26.0</span><br><span class="line">  001197                OBS REPORT TYPE                                                  CODE TABLE              1</span><br><span class="line">... (以下略) ...</span><br></pre></td></tr></table></figure>
<p>これで Table の準備が出来、BUFR データが読めるようになった。同梱されている他のプログラムも、この Table を用いれば利用可能となる。</p>
<p>次に、出力する要素を絞り、それらに緯度経度座標値を付加し、地理空間分布を描画してみる。その際、品質管理情報(AQC)を取得しておき、異常データを出来る限り省いた状態で出力してみる。LibECBUFR に同梱されているサンプルプログラムを改修し、<a target="_blank" rel="noopener" href="https://gitlab.com/unujma/unuwiki/-/snippets/2163731/raw/main/decode_bufr_sample.c">こちら</a>のようなプログラムを書いた。コンパイルし、Table ファイルを用意した上で引数に BUFR ファイルを指定すると、出力ファイルに緯度・経度・前10分間雨量・前10分間雨量 AQC 情報・前60分間雨量・前60分間雨量 AQC 情報をそれぞれ 1 地点 1 行で表示する。</p>
<p>コマンド</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUFR_TABLES=. ./decode_bufr_sample Z__C_RJTD_20200214000000_OBS_AMDS_Rjp_N2_bufr4.bin</span><br></pre></td></tr></table></figure>
<p>出力ファイル <code>OUTPUT.txt</code> (一部のみ表示)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">45.521111 141.936111 0.000000 0 0.000000 0</span><br><span class="line">45.415279 141.678604 0.000000 0 0.000000 0</span><br><span class="line">45.305279 141.045837 0.000000 0 0.000000 0</span><br><span class="line">... (中略) ...</span><br><span class="line">24.396391 124.245003 0.000000 0 0.000000 0</span><br><span class="line">24.264999 123.872223 0.000000 0 0.000000 0</span><br><span class="line">24.055559 123.768059 0.000000 0 0.000000 0</span><br></pre></td></tr></table></figure>
<h1 id="描画"><a class="markdownIt-Anchor" href="#描画"></a> 描画</h1>
<p>ようやく BUFR 形式のデータが読めるようになったので、可視化してみる。</p>
<img src="/blog/2021/08/16/bufr_1hrain.png" class="">
<p>元のデータは丸印で色分け、nearest neighbor 法で水平内挿したものを陰影でそれぞれ示している。このときは、九州南部から四国南西部にかけて数 mm 〜 10 mm 程度の降水があったようだ。</p>
<h1 id="終わりに"><a class="markdownIt-Anchor" href="#終わりに"></a> 終わりに</h1>
<p>地上のデータはすぐ手が届きそうな場所にあるようで、扱おうとするとなかなか遠い道のりだった。でも、これで地上観測データも Table さえ用意すれば読めるようになったので百人力である。今回は C 言語で LibECBUFR を利用した AMeDAS BUFR 報のデコードから可視化までを扱った。</p>
<h1 id="更新履歴"><a class="markdownIt-Anchor" href="#更新履歴"></a> 更新履歴</h1>
<ul>
<li>2021-08-16: 初稿</li>
<li>2021-08-19: サンプルプログラム等置き場所を GitLab の snippets に変更</li>
<li>2021-08-22: 誤字脱字を修正</li>
</ul>
</article><article id="post"><!-- Author: maupassant-hexo (https://github.com/tufu9441/maupassant-hexo/blob/master/layout/_partial/comments.pug)--><div id="disqus_thread"><div class="btn_click_load"><div class="disqus_click_btn"> <a class="article-comment">Read the comments (please make sure that Disqus can be loaded normally)</a></div></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://takashiunuma.github.io/blog/2021/08/16/';
    this.page.identifier = '2021/08/16/';
    this.page.title = '地上観測データの把握';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//unusblog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//unusblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://unusblog.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });</script></div></article><nav id="pagination"><div class="pagination clear-fix"><div class="page-prev pull-left"><a href="/blog/2021/08/19/"><i class="fa fa-chevron-left"> </i><span>KDP推定アルゴリズムの比較</span></a></div><div class="page-next pull-right"><a href="/blog/2021/07/28/"><span>降水強度のKDP推定アルゴリズムについて</span><i class="fa fa-chevron-right"></i></a></div></div></nav></div></div><footer><div id="footer-inner"><div class="social-icons"><a class="social-icon" href="https://scholar.google.co.jp/citations?user=8PamjYsAAAAJ" target="_blank"><i class="fa fa-google"></i></a><a class="social-icon" href="https://www.researchgate.net/profile/Takashi-Unuma" target="_blank"><i class="fa fa-graduation-cap"></i></a><a class="social-icon" href="https://orcid.org/0000-0003-4350-9758" target="_blank"><i class="fa fa-openid"></i></a><a class="social-icon" href="https://www.linkedin.com/in/takashiunuma/" target="_blank"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://twitter.com/UNUSB" target="_blank"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://www.instagram.com/unusb/" target="_blank"><i class="fa fa-instagram"></i></a><a class="social-icon" href="/blog/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><p class="design-info">Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://github.com/lazysheep666/terminal_theme" target="_blank">Teminal</a> (<a href="https://github.com/Tonny-Gu/terminal_theme" target="_blank">NekoDaemon Remix</a>)</p><p class="design-info"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a> 
Licensed | Copyright © 2022 Takashi Unuma</p></div></footer><script src="/blog/js/nav.js"></script><script src="/blog/js/scroll.js"></script><script src="/blog/js/index.js"></script></body></html>