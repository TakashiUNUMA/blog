<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Self-consistency Principle | Takashi Unuma's Blog</title><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"><script src="/blog/js/third-party/jquery.min.js"></script><script src="/blog/js/third-party/velocity.min.js"></script><script src="/blog/js/third-party/velocity.ui.min.js"></script><link rel="icon" href="/blog/img/favicon.ico"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/blog/atom.xml" title="Takashi Unuma's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="Takashi Unuma's Blog" type="application/rss+xml">
</head><body><nav id="nav-bar"><nav class="clear-fix" id="nav-container"><div class="pull-left" id="page-home"><a href="/blog/">Takashi Unuma's Blog</a></div><i class="fa fa-bars pull-right" id="toggle-nav" aria-hidden="true"></i><ul class="pull-right" id="navs"><li><a class="nav" href="/blog/">Home</a></li><li><a class="nav" href="/blog/about">About</a></li><li><a class="nav" href="/blog/tags">Tags</a></li></ul></nav></nav><header id="header-info"><div id="header-container"><div id="site-info"><div id="terminal-pl"><div id="top-bar"><ul id="control"><li class="btn"></li><li class="btn"></li><li class="btn"></li></ul><div id="file-path"><i class="fa fa-folder folder-ic" aria-hidden="true"></i> @GitHub</div></div><div id="code-pl">@github:~/blog$
<span class="code-pl-input">source &quot;Self-consistency Principle.sh&quot;</span><br><br>@github:~/blog$
<span class="code-pl-input">printenv</span><br><span class="code-pl-output">CREATED_DATE = 2021-09-04</span><br><span class="code-pl-output">UPDATED_DATE = 2021-09-10</span><br><span class="code-pl-output">TAGS =</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/tags/#Miscellaneous"><span class="code-pl-output">Miscellaneous</span></a><span class="code-pl-output"> </span><span class="code-pl-output"></span><br><br>@github:~/blog$
<span class="code-pl-input">grep -lr $TAGS post</span><br><span class="code-pl-output">2021-08-19</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/19/" target="_blank"><span class="code-pl-output">KDP推定アルゴリズムの比較</span></a><br><span class="code-pl-output">2021-03-23</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/23/" target="_blank"><span class="code-pl-output">Dew Point Temperature</span></a><br><span class="code-pl-output">2021-03-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/21/" target="_blank"><span class="code-pl-output">SONDE monitor</span></a><br><span class="code-pl-output">2021-09-04</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/04/" target="_blank"><span class="code-pl-output">Self-consistency Principle</span></a><br><span class="code-pl-output">2021-03-22</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/22/" target="_blank"><span class="code-pl-output">Signal Processing Methods</span></a><br><span class="code-pl-output">2021-03-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/20/" target="_blank"><span class="code-pl-output">The first page of my blog</span></a><br><span class="code-pl-output">2021-09-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/20/" target="_blank"><span class="code-pl-output">二重偏波レーダーとメソ対流系</span></a><br><span class="code-pl-output">2021-04-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/04/28/" target="_blank"><span class="code-pl-output">二重偏波要素の特徴</span></a><br><span class="code-pl-output">2021-08-16</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/16/" target="_blank"><span class="code-pl-output">地上観測データの把握</span></a><br><span class="code-pl-output">2021-08-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/28/" target="_blank"><span class="code-pl-output">二重偏波レーダー変数の算出とその補正</span></a><br><span class="code-pl-output">2021-07-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/07/28/" target="_blank"><span class="code-pl-output">降水強度のKDP推定アルゴリズムについて</span></a><br><!--if page.next| > .prev
br
a(href=url_for(page.next.path))
  span.answer= page.next.title
br
br--><!--if page.prev| > .next
br
a(href=url_for(page.prev.path))
  span.answer= page.prev.title--></div></div></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><a class="article-title">Self-consistency Principle</a><time class="article-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-09-04</time><h1>はじめに</h1>
<p>Self-consistency principle とは、Goddard et al. (1994) で提唱された、水平偏波反射強度 (Z, 以降、反射強度と略す) の校正方法の一つ。雨に対し、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">P</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>Z</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><msub><mi>Z</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{\rm DP}/Z \, = \, Z_{\rm DR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">P</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の関係から様々な粒径分布をシミュレーションしたものを真値として反射強度の校正をする、というもの。ただし、Goddard et al. (1994) の手法は降雨減衰が考慮されていないため、降雨減衰の影響が無視出来ない X・C バンドレーダーでは利用しにくいという欠点があった。Adachi et al. (2015) ではその欠点を補う、降雨減衰を考慮した校正方法が提案されている。</p>
<a href="/blog/2021/08/28/" title="二重偏波レーダー変数の算出とその補正">二重偏波レーダー変数の算出とその補正</a>では、校正済の反射強度が得られていることを前提としていた。降水強度推定に <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">P</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{\rm DP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">P</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> を用いるのであれば、反射強度の校正は必要ないじゃないか、と考えることも出来る。しかしながら、現業レーダーの場合、世界気象機関 (WMO) でレーダー変数のバイアスをある決められた値以下にしましょうという基準 (努力目標に近い) があり、その変数に反射強度も入っているため校正は必須となる。加えて、受信電力の弱い領域では反射強度を用いて降水強度を推定した方が、降水強度の推定精度が総合的に向上する場合が多い。なので、反射強度の校正は、気象レーダーそのものひいては降水強度の量的精度向上にとって必要かつ重要なプロセスなのである。本稿では Self-consistency principle による反射強度の校正について述べる。
<h1>実施環境</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://gitlab.com/unujma/unuwiki/-/wikis/Python#pyart">環境構築</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ARM-DOE/pyart">The Python ARM Radar Toolkit (Py-ART)</a></li>
</ul>
<p>今回は、<a target="_blank" rel="noopener" href="https://github.com/dmoisseev/T-matrix-Notebooks/blob/master/Self%20Consistency%20Notebook.ipynb">こちら</a>の ipython notebook に沿ってシミュレーションを行う。その後、<a target="_blank" rel="noopener" href="https://engineering.arm.gov/~jhelmus/pyart_example_data/sgpcsaprsurcmacI7.c0.20110520.095101.nc">こちら</a>の実データを用い、実際に校正が必要かどうか確認する。</p>
<h1>シミュレーション</h1>
<p>実施環境で環境構築したものに加え、下記を導入する。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install pytmatrix</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/jleinonen/pytmatrix/wiki">https://github.com/jleinonen/pytmatrix/wiki</a></p>
</blockquote>
<h2 id="雨滴粒径分布">雨滴粒径分布</h2>
<p>まず、異なる形状をした雨滴データを用意する。雨滴の縦横比を近似的に求める方法が幾つか提案されていて、<code>pytmatrix</code> に実装されている。</p>
<ul>
<li>Thurai et al. (2007)
<ul>
<li>2D-ビデオ観測で得られた雨滴の形状の近似式から縦横比を算出</li>
</ul>
</li>
<li>Beard and Chuang (1987)
<ul>
<li>平衡モデルから縦横比を算出</li>
</ul>
</li>
<li>Pruppacher and Beard (1970)
<ul>
<li>風洞実験データから縦横比を算出</li>
</ul>
</li>
</ul>
<p>図は下記の通り。横軸が雨滴の直径、縦軸が雨滴の縦横比。どの方法でも雨滴の直径が大きくなるにつれて縦横比が概ね小さくなる分布となる。</p>
<img src="/blog/2021/09/04/test_RainDropShape.png" class="">
<p>次に、上記で用意した異なる形状をした雨滴データから、雨滴粒径分布 (Drop Size Distribution) を算出する。雨滴粒径分布の推定は、Bringi and Chandrasekar (2001) の式 7.62 に則り規格化したガンマ分布を仮定する。その際、shape parameter (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span>)、雨滴の体積直径 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{\rm 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)、intercept parameter (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">N_{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) をそれぞれ与える。上図は <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{\rm 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の頻度分布、下図は <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">N_{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の頻度分布。それぞれ、雨滴粒径分布、1立方メートルあたりの密度と解釈できる。ピーク値でみると、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{\rm 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 1.7 mm 程度、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">N_{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 2000 mm<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{\rm -1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> m<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{\rm -3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathrm mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> 程度なので、層状性の降雨に近い分布である。もう少し値の大きい <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{\rm 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> も含まれているので、対流性のものも混じっているようだ。</p>
<img src="/blog/2021/09/04/test_SimulatedDSD.png" class="">
<h2 id="レーダー変数推定">レーダー変数推定</h2>
<p>上記で得た雨滴粒径分布から、反射強度・反射因子差・偏波間位相差変化率をそれぞれ求める。確認のため、反射強度と反射因子差の頻度分布を下図に示す。反射強度の値が大きくなるとともに、反射因子差の値が大きくなるような分布をしている。反射強度の大きい雨粒ほど扁平な形状をしているようだ。</p>
<img src="/blog/2021/09/04/test_ZHvsZDR.png" class="">
<h2 id="swig￼13-分布"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>K</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">P</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>Z</mi><mo stretchy="false">)</mo><mtext> </mtext><mo>=</mo><mtext> </mtext><msub><mi>Z</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f(K_{\rm DP}/Z) \, = \, Z_{\rm DR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">P</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分布</h2>
<p>ようやく Self-consistency の関係を確認する準備が整った。横軸に <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{\rm DR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、縦軸に <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">P</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">K_{\rm DP}/Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">P</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> をとり頻度分布を描いたものが下図。0.00007 degree km<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{\rm -1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> mm<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><annotation encoding="application/x-tex">^{\rm -6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathrm mtight">6</span></span></span></span></span></span></span></span></span></span></span></span></span> m<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">^{\rm 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> をピーク値とし、それ以降は <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{\rm DR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">D</span><span class="mord mathrm mtight">R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の増加とともにべき乗で減少するような分布をしている。今回は雨滴粒径分布をシミュレーションで算出したけれども、可能であればディスドロメータやビデオ観測等を用いて実際の雨滴粒径分布を得た上で真値を算出すると、より高精度の真値が得られると考えられる。</p>
<img src="/blog/2021/09/04/test_KDPpZHvsZDR.png" class="">
<h1>実例</h1>
<p>上記までで、シミュレーションによる真値が得られた。簡単に言うと、この真値とのズレが反射強度のバイアスと考えることが出来る (反射因子差・偏波間位相差変化率がそれぞれ正しく校正されていることが前提)。サンプルデータで反射強度の校正の余地があるかどうか実際に調べてみる。下図は、暖色系ほど頻度が高く寒色系ほど頻度が低くなっている。頻度の高い分布を辿ると、概ね先程確認したシミュレーションの分布に近いところにある。ただし、先程のシミュレーションでは気温が 10<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mo lspace="0em" rspace="0em">∘</mo></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^{\circ}C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.674115em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∘</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> のみを対象としている一方で実例では全ての仰角分を描画している。このため、全てのデータがシミュレーションの分布に乗る訳ではない。正確に行うならば、用いるデータの仰角・高度情報から気温を推定し、条件に一致するデータのみを取り出す必要があるだろう。</p>
<img src="/blog/2021/09/04/selfconsistency_ok.png" class="">
<h1>おわりに</h1>
<p>今回は、Self-consistency principle と銘打って反射強度の校正について扱った。</p>
<h1>参考文献</h1>
<ul>
<li>Adachi, A., T. Kobayashi, H. Yamauchi, 2015: Estimation of raindrop size distribution and rainfall rate from polarimetric radar measurements at attenuating frequency based on the self-consistency principle. J. Meteor. Soc. Japan, 93A, 359–388.</li>
<li>Beard, K. V., and C. Chuang, 1987: A new model for the equilibrium shape of raindrops. J. Atmos. Sci., 44, 1509–1524.</li>
<li>Bringi, V. N. and V. Chandrasekar, 2001: Polarimetric Doppler Weather Radar: Principles and Applications. Cambridge University Press, 636 pp.</li>
<li>Goddard, J. W. F., J. Tan, and M. Thurai, 1994: Technique for calibration of meteorological radars using differential phase. Electron. Lett., 30, 166–167.</li>
<li>Pruppacher, H. R., and K. V. Beard, 1970: A wind tunnel investigation of the internal circulation and shape of water drops falling at terminal velocity in air. Quart. J. Roy. Meteor. Soc., 96, 247–256.</li>
<li>Thurai, M., G. J. Huang, V. N. Bringi, W. L. Randeu, and M. Schönhuber, 2007: Drop shapes, model comparisons, and calculations of polarimetric radar parameters in rain. J. Atmos. Oceanic Technol., 24, 1019–1032.</li>
</ul>
<h1>更新履歴</h1>
<ul>
<li>2021-09-04: 初稿</li>
<li>2021-09-09: 誤字を修正</li>
</ul>
</article><article id="post"><!-- Author: maupassant-hexo (https://github.com/tufu9441/maupassant-hexo/blob/master/layout/_partial/comments.pug)--><div id="disqus_thread"><div class="btn_click_load"><div class="disqus_click_btn"> <a class="article-comment">Read the comments (please make sure that Disqus can be loaded normally)</a></div></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://takashiunuma.github.io/blog/2021/09/04/';
    this.page.identifier = '2021/09/04/';
    this.page.title = 'Self-consistency Principle';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//unusblog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//unusblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://unusblog.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });</script></div></article><nav id="pagination"><div class="pagination clear-fix"><div class="page-prev pull-left"><a href="/blog/2021/09/20/"><i class="fa fa-chevron-left"> </i><span>二重偏波レーダーとメソ対流系</span></a></div><div class="page-next pull-right"><a href="/blog/2021/08/28/"><span>二重偏波レーダー変数の算出とその補正</span><i class="fa fa-chevron-right"></i></a></div></div></nav></div></div><footer><div id="footer-inner"><div class="social-icons"><a class="social-icon" href="https://scholar.google.co.jp/citations?user=8PamjYsAAAAJ" target="_blank"><i class="fa fa-google"></i></a><a class="social-icon" href="https://www.researchgate.net/profile/Takashi-Unuma" target="_blank"><i class="fa fa-graduation-cap"></i></a><a class="social-icon" href="https://orcid.org/0000-0003-4350-9758" target="_blank"><i class="fa fa-openid"></i></a><a class="social-icon" href="https://www.linkedin.com/in/takashiunuma/" target="_blank"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://twitter.com/UNUSB" target="_blank"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://www.instagram.com/unusb/" target="_blank"><i class="fa fa-instagram"></i></a><a class="social-icon" href="/blog/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><p class="design-info">Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://github.com/lazysheep666/terminal_theme" target="_blank">Teminal</a> (<a href="https://github.com/Tonny-Gu/terminal_theme" target="_blank">NekoDaemon Remix</a>)</p><p class="design-info"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a> 
Licensed | Copyright © 2021 Takashi Unuma</p></div></footer><script src="/blog/js/nav.js"></script><script src="/blog/js/scroll.js"></script><script src="/blog/js/index.js"></script></body></html>