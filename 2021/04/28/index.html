<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>二重偏波要素の特徴 | Takashi Unuma's Blog</title><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"><script src="/blog/js/third-party/jquery.min.js"></script><script src="/blog/js/third-party/velocity.min.js"></script><script src="/blog/js/third-party/velocity.ui.min.js"></script><link rel="icon" href="/blog/img/favicon.ico"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/blog/atom.xml" title="Takashi Unuma's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="Takashi Unuma's Blog" type="application/rss+xml">
</head><body><nav id="nav-bar"><nav class="clear-fix" id="nav-container"><div class="pull-left" id="page-home"><a href="/blog/">Takashi Unuma's Blog</a></div><i class="fa fa-bars pull-right" id="toggle-nav" aria-hidden="true"></i><ul class="pull-right" id="navs"><li><a class="nav" href="/blog/">Home</a></li><li><a class="nav" href="/blog/about">About</a></li><li><a class="nav" href="/blog/tags">Tags</a></li></ul></nav></nav><header id="header-info"><div id="header-container"><div id="site-info"><div id="terminal-pl"><div id="top-bar"><ul id="control"><li class="btn"></li><li class="btn"></li><li class="btn"></li></ul><div id="file-path"><i class="fa fa-folder folder-ic" aria-hidden="true"></i> @GitHub</div></div><div id="code-pl">@github:~/blog$
<span class="code-pl-input">source &quot;二重偏波要素の特徴.sh&quot;</span><br><br>@github:~/blog$
<span class="code-pl-input">printenv</span><br><span class="code-pl-output">CREATED_DATE = 2021-04-28</span><br><span class="code-pl-output">UPDATED_DATE = 2021-04-29</span><br><span class="code-pl-output">TAGS =</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/tags/#Miscellaneous"><span class="code-pl-output">Miscellaneous</span></a><span class="code-pl-output"> </span><span class="code-pl-output"></span><br><br>@github:~/blog$
<span class="code-pl-input">grep -lr $TAGS post</span><br><span class="code-pl-output">2021-03-23</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/23/" target="_blank"><span class="code-pl-output">Dew Point Temperature</span></a><br><span class="code-pl-output">2021-08-19</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/19/" target="_blank"><span class="code-pl-output">KDP推定アルゴリズムの比較</span></a><br><span class="code-pl-output">2022-10-12</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2022/10/12/" target="_blank"><span class="code-pl-output">Open Radar Science</span></a><br><span class="code-pl-output">2021-03-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/21/" target="_blank"><span class="code-pl-output">SONDE monitor</span></a><br><span class="code-pl-output">2021-09-04</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/04/" target="_blank"><span class="code-pl-output">Self-consistency Principle</span></a><br><span class="code-pl-output">2021-03-22</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/22/" target="_blank"><span class="code-pl-output">Signal Processing Methods</span></a><br><span class="code-pl-output">2021-03-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/03/20/" target="_blank"><span class="code-pl-output">The first page of my blog</span></a><br><span class="code-pl-output">2021-09-20</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/09/20/" target="_blank"><span class="code-pl-output">二重偏波レーダーとメソ対流系</span></a><br><span class="code-pl-output">2021-08-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/28/" target="_blank"><span class="code-pl-output">二重偏波レーダー変数の算出とその補正</span></a><br><span class="code-pl-output">2021-04-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/04/28/" target="_blank"><span class="code-pl-output">二重偏波要素の特徴</span></a><br><span class="code-pl-output">2022-01-26</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2022/01/26/" target="_blank"><span class="code-pl-output">反射強度・反射因子差のバイアス補正</span></a><br><span class="code-pl-output">2021-08-16</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/08/16/" target="_blank"><span class="code-pl-output">地上観測データの把握</span></a><br><span class="code-pl-output">2021-10-01</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/10/01/" target="_blank"><span class="code-pl-output">粒径分布とレーダー変数</span></a><br><span class="code-pl-output">2021-07-28</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/blog/2021/07/28/" target="_blank"><span class="code-pl-output">降水強度のKDP推定アルゴリズムについて</span></a><br><!--if page.next| > .prev
br
a(href=url_for(page.next.path))
  span.answer= page.next.title
br
br--><!--if page.prev| > .next
br
a(href=url_for(page.prev.path))
  span.answer= page.prev.title--></div></div></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><a class="article-title">二重偏波要素の特徴</a><time class="article-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-28</time><h1 id="はじめに"><a class="markdownIt-Anchor" href="#はじめに"></a> はじめに</h1>
<p>以前、<a href="/blog/2021/03/22/" title="Signal Processing Methods">Signal Processing Methods</a> という記事を書いた。言葉だけだとどうもイメージが沸かないので、実際のデータで図を描いてみることにした。最近では Python 関連の便利でたくさんのパッケージが出回っている。いろいろと試した結果、ここでは <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>radlib を用いることにした。Python や <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>radlib の環境構築については、<a href="https://gitlab.com/unujma/unuwiki/-/wikis/Python" title="" target="">こちら</a>を参照されたい。</p>
<h1 id="降水非降水エコー"><a class="markdownIt-Anchor" href="#降水非降水エコー"></a> 降水・非降水エコー</h1>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>radlib で Simple fuzzy echo classification (ファジーロジックによるエコー判別) が出来るので、一例を示す。<a href="https://docs.wradlib.org/en/stable/notebooks/classify/wradlib_fuzzy_echo_classify.html" title="" target="">ここ</a>に書いてあるとおりにコマンドを打つと、下記の図が出来る。
<img src="/blog/2021/04/28/fuzzy_echo_classification.png" class="">
<p>左図は水平偏波反射強度 (dBZ)、右図は判別結果。エコー判別は、0 で降水エコー 1 で非降水エコーをそれぞれ示す。例えば、サイト中心付近の弱いエコー域は判別結果だと 1 に近いので非降水エコーと見なせる、らしい。これだとブラックボックス過ぎてよく分からないので、幾つかの要素を詳しく観てみる。</p>
<h2 id="偏波間位相差-swig3-"><a class="markdownIt-Anchor" href="#偏波間位相差-swig3-"></a> 偏波間位相差 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ψ</mi><mrow><mi>d</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\psi_{dp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>)</h2>
<img src="/blog/2021/04/28/pdp.png" class="">
<p>左図は上図と同じ、右図は偏波間位相差。偏波間位相差は、水平偏波の位相変化と垂直偏波の位相変化との差。受信電力から求めた場合は受信電力偏波間位相差と言うらしい。今回示した図は、受信電力偏波間位相差からノイズを取り除き、スムージングを掛け、正常値以外の領域では無効値になっている模様。このため、値域は -180度〜180度に収まっているようだ。粒経の大きい扁平な雨滴が観測された場合、垂直偏波よりも水平偏波の位相が遅れる。これを利用して降水強度推定にも利用される。判別結果と偏波間位相差とを見比べると、偏波間位相差の値が算出されている領域はほぼ降水エコーとなっているようだ。偏波間位相差の有効・無効も影響しているかもしれない。</p>
<h2 id="偏波間相関係数-swig4-hv"><a class="markdownIt-Anchor" href="#偏波間相関係数-swig4-hv"></a> 偏波間相関係数 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">ρ</span></span></span></span>hv)</h2>
<img src="/blog/2021/04/28/rhv.png" class="">
<p>右図のみ偏波間相関係数に変更。偏波間相関係数は、水平偏波と水平偏波との信号の相関係数。ある観測領域内の散乱体について一様性の度合いを表す。値域は 0〜1 をとり、1 に近いほど一様性が高い (雨粒)。雹や融解層内の雨滴は一様性がやや低い。また、生物やクラッタの場合は一様性が低い傾向にある。判別結果と偏波間相関係数とを見比べると、サイト中心付近で非降水エコーと判別された部分は、なるほど偏波間相関係数の値が低い。一方、水平偏波反射強度で比較的値の大きいエコー域でかつ偏波間相関係数の大きい領域は、降水エコーとして判別されている。</p>
<h2 id="反射因子差-swig5-"><a class="markdownIt-Anchor" href="#反射因子差-swig5-"></a> 反射因子差 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><mi>D</mi><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{DR}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</h2>
<img src="/blog/2021/04/28/zdr.png" class="">
<p>右図のみ反射因子差に変更。反射因子差は、水平偏波と垂直偏波の反射因子の比 (或いは、強度 (dBZ) の差) の値で、散乱体の縦横比を表す。典型的な値域は -4〜10 dB。球形に近いほど値は 0 に近く、扁平な形状ほど値が大きくなる。反射因子差の値を観てみると、サイト中心の南側にあるエコー域で負の値と正の値とが混在している。この領域は、偏波間相関係数の値も低く、判別結果も非降水エコーになっている。</p>
<p>以上、サンプルデータで概観してみたものの、それぞれの特徴を観る上で十分な情報量が含まれていたように思う。続いて、適切な反射強度・降水強度算出に欠かせない、降雨減衰補正について述べる。</p>
<h1 id="降雨減衰補正"><a class="markdownIt-Anchor" href="#降雨減衰補正"></a> 降雨減衰補正</h1>
<p>レーダービームが強雨域をレンジ方向に通過した場合、強雨域のレンジ後方で送信電力(レーダー側では受信電力)がレーダーの波長によっては著しく減衰してしまう。この減衰量を推定し、降雨による減衰としてを補正するのが降雨減衰補正である。<a href="https://docs.wradlib.org/en/stable/notebooks/workflow/recipe1.html" title="" target="">ここ</a>に書いてあるコマンドを少し変更し、降雨減衰補正前・降雨減衰補正後の図をそれぞれ作成した。ドイツ気象局管轄の Feldberg と Tuerkheim というレーダーサイトの合成図になっている。</p>
<img src="/blog/2021/04/28/R-Z.png" class="">
<img src="/blog/2021/04/28/R-Zcorr.png" class="">
<p>降雨減衰補正後のデータは、降雨減衰補正前に比べ緑〜黄色 (例えば 100 mm/h 以上) の領域が広くなっており、適切に補正されている、らしい。パラメータは恐らくこの地域にあわせてあるのかもしれない。この例では、減衰補正の手法として <a href="https://docs.wradlib.org/en/stable/generated/wradlib.atten.correct_attenuation_constrained.html" title="" target="">Modified Kraemer algorithm</a> が用いられているようだ。補正方法は他にもあり、オプションとして用意されている他、各国でやり方も異なるようだ。</p>
<h1 id="おわりに"><a class="markdownIt-Anchor" href="#おわりに"></a> おわりに</h1>
<p>初学者にも使いやすいライブラリを提供してくださっている <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>radlib プロジェクトやその関連プロジェクトに関わる方々に対し謝意を示す。</p>
<h1 id="参考"><a class="markdownIt-Anchor" href="#参考"></a> 参考</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://wradlib.org/">https://wradlib.org/</a></li>
</ul>
<hr />
<h1 id="更新履歴"><a class="markdownIt-Anchor" href="#更新履歴"></a> 更新履歴</h1>
<ul>
<li>2021-04-28: 初稿</li>
<li>2021-04-29: 降雨減衰補正を追記、体裁修正。</li>
</ul>
</article><article id="post"><!-- Author: maupassant-hexo (https://github.com/tufu9441/maupassant-hexo/blob/master/layout/_partial/comments.pug)--><div id="disqus_thread"><div class="btn_click_load"><div class="disqus_click_btn"> <a class="article-comment">Read the comments (please make sure that Disqus can be loaded normally)</a></div></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://takashiunuma.github.io/blog/2021/04/28/';
    this.page.identifier = '2021/04/28/';
    this.page.title = '二重偏波要素の特徴';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//unusblog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//unusblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://unusblog.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });</script></div></article><nav id="pagination"><div class="pagination clear-fix"><div class="page-prev pull-left"><a href="/blog/2021/07/28/"><i class="fa fa-chevron-left"> </i><span>降水強度のKDP推定アルゴリズムについて</span></a></div><div class="page-next pull-right"><a href="/blog/2021/03/23/"><span>Dew Point Temperature</span><i class="fa fa-chevron-right"></i></a></div></div></nav></div></div><footer><div id="footer-inner"><div class="social-icons"><a class="social-icon" href="https://scholar.google.co.jp/citations?user=8PamjYsAAAAJ" target="_blank"><i class="fa fa-google"></i></a><a class="social-icon" href="https://www.researchgate.net/profile/Takashi-Unuma" target="_blank"><i class="fa fa-graduation-cap"></i></a><a class="social-icon" href="https://orcid.org/0000-0003-4350-9758" target="_blank"><i class="fa fa-openid"></i></a><a class="social-icon" href="https://www.linkedin.com/in/takashiunuma/" target="_blank"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://twitter.com/UNUSB" target="_blank"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://www.instagram.com/unusb/" target="_blank"><i class="fa fa-instagram"></i></a><a class="social-icon" href="/blog/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><p class="design-info">Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://github.com/lazysheep666/terminal_theme" target="_blank">Teminal</a> (<a href="https://github.com/Tonny-Gu/terminal_theme" target="_blank">NekoDaemon Remix</a>)</p><p class="design-info"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a> 
Licensed | Copyright © 2023 Takashi Unuma</p></div></footer><script src="/blog/js/nav.js"></script><script src="/blog/js/scroll.js"></script><script src="/blog/js/index.js"></script></body></html>